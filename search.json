[
  {
    "objectID": "core.html",
    "href": "core.html",
    "title": "core",
    "section": "",
    "text": "def test_command(command: str) -&gt; Optional[int]:\n    \"\"\"\n    Test if a command is available and print its first line of output.\n    \n    Args:\n        command: The command to test (e.g., 'mmseqs', 'samtools', 'blastn').\n    \n    Returns:\n        Optional[int]: Return code from the command, or None if execution fails.\n    \"\"\"\n    try:\n        result = subprocess.run(\n            [command],\n            capture_output=True,\n            text=True,\n            timeout=5\n        )\n        \n        # Print first line of output (usually version/help info)\n        if result.stdout:\n            first_line = result.stdout.split('\\n')[0]\n            print(first_line)\n        elif result.stderr:\n            first_line = result.stderr.split('\\n')[0]\n            print(first_line)\n        \n        print(f\"Return code: {result.returncode}\")\n        return result.returncode\n        \n    except Exception as e:\n        print(f\"Error running {command}: {e}\")\n        return None\n\n\ntest_command('mmseqs')\n\nMMseqs2 (Many against Many sequence searching) is an open-source software suite for very fast, \nReturn code: 0\n\n\n0\n\n\n\ntest_command('spades.py')\n\nSPAdes genome assembler v4.2.0\nReturn code: 0\n\n\n0\n\n\n\nsource\n\nretrieve_and_save_sequence\n\n retrieve_and_save_sequence (fasta_file:Union[str,pathlib.Path],\n                             fasta_id:str, start:int, end:int,\n                             output_file:Union[str,pathlib.Path])\n\n*Retrieve a subsequence from a FASTA file and save it to a new file.\nArgs: fasta_file: Path to the input FASTA file. fasta_id: The ID of the sequence to retrieve. start: The starting position (1-based, inclusive). end: The ending position (1-based, inclusive). output_file: Path to the output FASTA file.\nReturns: str: Success message with output file path, or None if error occurs.\nRaises: ValueError: If fasta_id not found, or if start/end positions are invalid. FileNotFoundError: If input FASTA file doesn’t exist.\nExample: &gt;&gt;&gt; retrieve_and_save_sequence(‘genome.fasta’, ‘chr1’, 100, 200, ‘output.fasta’) ‘Sequence saved to output.fasta’*\n\ntest_fasta = \"test.fasta\"\nseq = 'A C G T A C G T A'.replace(' ','')\n#      1 2 3 4 5 6 7 8 9\nwith open(test_fasta, \"w\") as f:\n    f.write(f\"&gt;seq1\\n{seq}\\n\")\n\n# Test the function\nretrieve_and_save_sequence(\"test.fasta\", \"seq1\", 3, 7, \"output.fasta\")\n\n# Check the output\nfor record in SeqIO.parse(\"output.fasta\", \"fasta\"):\n    print(f\"ID: {record.id}\")\n    print(f\"Sequence: {record.seq}\")\n    assert(record.seq == 'GTACG')\n!rm output.fasta\n\nID: seq1_3_7\nSequence: GTACG",
    "crumbs": [
      "core"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "gene_finder",
    "section": "",
    "text": "We have several short-read WGS sequencing datasets from our mode of action studies. Sometimes we need to retrieve the full length of a coding sequence when it’s not well-annotated in public databases.\nWe can leverage SPAdes for de novo assembly and MMseqs2 for rapid gene finding to quickly identify and extract complete gene sequences from our sequencing data.\n\n\n\nFirst, install the required tools using conda:\nconda install -c conda-forge -c bioconda mmseqs2 spades\n\n# our sequence libraries\n!ls /Users/mtinti/git_projects/gene_finder/data/*q.gz\n\n/Users/mtinti/git_projects/gene_finder/data/V350230622_L01_B5GANIdzjaRAAAA-1_R1.fastq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350230622_L01_B5GANIdzjaRAAAA-1_R2.fastq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L02_B5GANIokjbRAAAA-128_1.fq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L02_B5GANIokjbRAAAA-128_2.fq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L03_B5GANIokjbRAAAA-128_1.fq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L03_B5GANIokjbRAAAA-128_2.fq.gz\n\n\n\n\n\nThis is the most time comsing part, this dataset run for 1h approx\nspades.py -t 100 \\\n--pe1-1 ../data/V350230622_L01_B5GANIdzjaRAAAA-1_R1.fastq.gz \\\n--pe1-2 ../data/V350230622_L01_B5GANIdzjaRAAAA-1_R2.fastq.gz \\\n--pe2-1 ../data/V350370689_L02_B5GANIokjbRAAAA-128_1.fq.gz \\\n--pe2-2 ../data/V350370689_L02_B5GANIokjbRAAAA-128_2.fq.gz \\\n--pe3-1 ../data/V350370689_L03_B5GANIokjbRAAAA-128_1.fq.gz \\\n--pe3-2 ../data/V350370689_L03_B5GANIokjbRAAAA-128_2.fq.gz \\\n-o ../data/output_Tc_Sylvio\n\n\n\nNow we use mmseq2 to look for our gene on interest in the assebled scaffolds\n!mmseqs easy-search --search-type 3 \\\n--format-output  query,evalue,qstart,qend,qlen,target,tstart,tend,tlen \\\n../data/CLK1_CDS_Dm28c.fa ../data/output_Tc_Sylvio/scaffolds.fasta \\\n../data/out.CLK1.tsv ../data/tmp\n\n#peek into the output\n!head ../data/out.CLK1.tsv\n\nCLK1    0.000E+00   369 1458    1458    NODE_2457_length_1097_cov_126.120588    1   1090    1097\nCLK1    2.871E-225  1   445 1458    NODE_289_length_20803_cov_57.477757 20359   20803   20803\nCLK1    1.021E-38   445 354 1458    NODE_2388_length_1130_cov_56.830959 1   92  1130\nCLK1    1.716E-25   1389    1458    1458    NODE_1614_length_1713_cov_44.015892 1   70  1713\nCLK1    1.716E-25   1389    1458    1458    NODE_55_length_75916_cov_61.009375  1   70  75916\n\n\n\nThe CLK1 sequence is split into two contigs\n\nNODE_2457 contains the second part of CLK1, NODE_289 contains the first part of CLK1. The two contigs do not permit to reconstruct the full sequence\n\n\n\nlet’s grab anyway the two sequences\n\nretrieve_and_save_sequence('../data/output_Tc_Sylvio/scaffolds.fasta',\n                           'NODE_2457_length_1097_cov_126.120588',\n                           1,1090,'../data/out_NODE_2457.fa')\n\n'Sequence saved to ../data/out_NODE_2457.fa'\n\n\n\nretrieve_and_save_sequence('../data/output_Tc_Sylvio/scaffolds.fasta',\n                           'NODE_289_length_20803_cov_57.477757',\n                           20359,20803,'../data/out_NODE_289.fa')\n\n'Sequence saved to ../data/out_NODE_289.fa'\n\n\n\n\n\n\n!cp ../data/out_NODE_289.fa .\n!cp ../data/out_NODE_2457.fa .\n!cp ../data/TcCLK1_CM118357.1.fa .\n\n\nimport biotite.sequence as seq\nimport biotite.sequence.io.fasta as fasta\nimport biotite.sequence.align as align\nimport biotite.sequence.graphics as graphics\nimport matplotlib.pyplot as plt\n\n# Load sequences\nsequences = []\nlabels = []\nfiles = [\n    'TcCLK1_CM118357.1.fa',\n    'out_NODE_289.fa',\n    'out_NODE_2457.fa'\n]\n\nfor file_path in files:\n    fasta_file = fasta.FastaFile.read(file_path)\n    for header, seq_string in fasta_file.items():\n        sequences.append(seq.NucleotideSequence(seq_string))\n        labels.append(header)\n\n# Perform multiple sequence alignment\nmatrix = align.SubstitutionMatrix.std_nucleotide_matrix()\nalignment, order, _, _ = align.align_multiple(sequences, matrix, gap_penalty=(-15, -2))\n\n# Reorder to match your input order\nalignment = alignment[:, [0, 2, 1]]\n\nlabels = ['TcCLK1','NODE_2457','NODE_289']\n# Visualize\nfig, ax = plt.subplots(figsize=(12, 40))\ngraphics.plot_alignment_similarity_based(\n    ax, alignment, labels=labels, symbols_per_line=30,\n    show_numbers=True,\n    show_line_position=True,\n)\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nFrom our sequencing data it seems we have a synonymous mutation",
    "crumbs": [
      "gene_finder"
    ]
  },
  {
    "objectID": "index.html#quick-gene-assembly-and-annotation-pipeline",
    "href": "index.html#quick-gene-assembly-and-annotation-pipeline",
    "title": "gene_finder",
    "section": "",
    "text": "We have several short-read WGS sequencing datasets from our mode of action studies. Sometimes we need to retrieve the full length of a coding sequence when it’s not well-annotated in public databases.\nWe can leverage SPAdes for de novo assembly and MMseqs2 for rapid gene finding to quickly identify and extract complete gene sequences from our sequencing data.\n\n\n\nFirst, install the required tools using conda:\nconda install -c conda-forge -c bioconda mmseqs2 spades\n\n# our sequence libraries\n!ls /Users/mtinti/git_projects/gene_finder/data/*q.gz\n\n/Users/mtinti/git_projects/gene_finder/data/V350230622_L01_B5GANIdzjaRAAAA-1_R1.fastq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350230622_L01_B5GANIdzjaRAAAA-1_R2.fastq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L02_B5GANIokjbRAAAA-128_1.fq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L02_B5GANIokjbRAAAA-128_2.fq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L03_B5GANIokjbRAAAA-128_1.fq.gz\n/Users/mtinti/git_projects/gene_finder/data/V350370689_L03_B5GANIokjbRAAAA-128_2.fq.gz\n\n\n\n\n\nThis is the most time comsing part, this dataset run for 1h approx\nspades.py -t 100 \\\n--pe1-1 ../data/V350230622_L01_B5GANIdzjaRAAAA-1_R1.fastq.gz \\\n--pe1-2 ../data/V350230622_L01_B5GANIdzjaRAAAA-1_R2.fastq.gz \\\n--pe2-1 ../data/V350370689_L02_B5GANIokjbRAAAA-128_1.fq.gz \\\n--pe2-2 ../data/V350370689_L02_B5GANIokjbRAAAA-128_2.fq.gz \\\n--pe3-1 ../data/V350370689_L03_B5GANIokjbRAAAA-128_1.fq.gz \\\n--pe3-2 ../data/V350370689_L03_B5GANIokjbRAAAA-128_2.fq.gz \\\n-o ../data/output_Tc_Sylvio\n\n\n\nNow we use mmseq2 to look for our gene on interest in the assebled scaffolds\n!mmseqs easy-search --search-type 3 \\\n--format-output  query,evalue,qstart,qend,qlen,target,tstart,tend,tlen \\\n../data/CLK1_CDS_Dm28c.fa ../data/output_Tc_Sylvio/scaffolds.fasta \\\n../data/out.CLK1.tsv ../data/tmp\n\n#peek into the output\n!head ../data/out.CLK1.tsv\n\nCLK1    0.000E+00   369 1458    1458    NODE_2457_length_1097_cov_126.120588    1   1090    1097\nCLK1    2.871E-225  1   445 1458    NODE_289_length_20803_cov_57.477757 20359   20803   20803\nCLK1    1.021E-38   445 354 1458    NODE_2388_length_1130_cov_56.830959 1   92  1130\nCLK1    1.716E-25   1389    1458    1458    NODE_1614_length_1713_cov_44.015892 1   70  1713\nCLK1    1.716E-25   1389    1458    1458    NODE_55_length_75916_cov_61.009375  1   70  75916\n\n\n\nThe CLK1 sequence is split into two contigs\n\nNODE_2457 contains the second part of CLK1, NODE_289 contains the first part of CLK1. The two contigs do not permit to reconstruct the full sequence\n\n\n\nlet’s grab anyway the two sequences\n\nretrieve_and_save_sequence('../data/output_Tc_Sylvio/scaffolds.fasta',\n                           'NODE_2457_length_1097_cov_126.120588',\n                           1,1090,'../data/out_NODE_2457.fa')\n\n'Sequence saved to ../data/out_NODE_2457.fa'\n\n\n\nretrieve_and_save_sequence('../data/output_Tc_Sylvio/scaffolds.fasta',\n                           'NODE_289_length_20803_cov_57.477757',\n                           20359,20803,'../data/out_NODE_289.fa')\n\n'Sequence saved to ../data/out_NODE_289.fa'\n\n\n\n\n\n\n!cp ../data/out_NODE_289.fa .\n!cp ../data/out_NODE_2457.fa .\n!cp ../data/TcCLK1_CM118357.1.fa .\n\n\nimport biotite.sequence as seq\nimport biotite.sequence.io.fasta as fasta\nimport biotite.sequence.align as align\nimport biotite.sequence.graphics as graphics\nimport matplotlib.pyplot as plt\n\n# Load sequences\nsequences = []\nlabels = []\nfiles = [\n    'TcCLK1_CM118357.1.fa',\n    'out_NODE_289.fa',\n    'out_NODE_2457.fa'\n]\n\nfor file_path in files:\n    fasta_file = fasta.FastaFile.read(file_path)\n    for header, seq_string in fasta_file.items():\n        sequences.append(seq.NucleotideSequence(seq_string))\n        labels.append(header)\n\n# Perform multiple sequence alignment\nmatrix = align.SubstitutionMatrix.std_nucleotide_matrix()\nalignment, order, _, _ = align.align_multiple(sequences, matrix, gap_penalty=(-15, -2))\n\n# Reorder to match your input order\nalignment = alignment[:, [0, 2, 1]]\n\nlabels = ['TcCLK1','NODE_2457','NODE_289']\n# Visualize\nfig, ax = plt.subplots(figsize=(12, 40))\ngraphics.plot_alignment_similarity_based(\n    ax, alignment, labels=labels, symbols_per_line=30,\n    show_numbers=True,\n    show_line_position=True,\n)\nplt.tight_layout()\nplt.show()\n\n\n\n\n\n\n\n\n\n\n\nFrom our sequencing data it seems we have a synonymous mutation",
    "crumbs": [
      "gene_finder"
    ]
  },
  {
    "objectID": "index.html#developer-guide",
    "href": "index.html#developer-guide",
    "title": "gene_finder",
    "section": "Developer Guide",
    "text": "Developer Guide\nIf you are new to using nbdev here are some useful pointers to get you started.\n\nInstall gene_finder in Development mode\n# make sure gene_finder package is installed in development mode\n$ pip install -e .\n\n# make changes under nbs/ directory\n# ...\n\n# compile to have changes apply to gene_finder\n$ nbdev_prepare",
    "crumbs": [
      "gene_finder"
    ]
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "gene_finder",
    "section": "Usage",
    "text": "Usage\n\nInstallation\nInstall latest from the GitHub repository:\n$ pip install git+https://github.com/mtinti/gene_finder.git\nor from conda\n$ conda install -c mtinti gene_finder\nor from pypi\n$ pip install gene_finder\n\n\nDocumentation\nDocumentation can be found hosted on this GitHub repository’s pages. Additionally you can find package manager specific guidelines on conda and pypi respectively.",
    "crumbs": [
      "gene_finder"
    ]
  },
  {
    "objectID": "index.html#how-to-use",
    "href": "index.html#how-to-use",
    "title": "gene_finder",
    "section": "How to use",
    "text": "How to use\nFill me in please! Don’t forget code examples:\n\n1+1\n\n2",
    "crumbs": [
      "gene_finder"
    ]
  }
]